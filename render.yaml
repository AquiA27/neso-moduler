# Render.com configuration file
# Bu dosyayı proje root'unda tut (backend/ değil, root'ta)
# https://render.com/docs/yaml-spec

services:
  - type: web
    name: neso-moduler-backend
    env: python
    region: frankfurt  # Frankfurt (EU Central) - Türkiye için en iyi
    plan: starter  # veya free (test için), professional (production için)
    buildCommand: pip install --upgrade pip --cache-dir /tmp/pip-cache && pip install --cache-dir /tmp/pip-cache -r backend/requirements.txt
    startCommand: cd backend && uvicorn app.main:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /ping
    envVars:
      # Database - Render PostgreSQL connection string
      # Format: postgresql+asyncpg://user:pass@host:port/db
      - key: DATABASE_URL
        sync: false  # Manuel olarak ayarla (Render database URL'ini kullan)
      
      # JWT Secret
      - key: SECRET_KEY
        generateValue: true  # Render otomatik oluşturur
      
      # Environment
      - key: ENV
        value: prod
      
      # CORS Origins (Vercel frontend URL'leri - deployment sonrası güncelleyin)
      - key: CORS_ORIGINS
        sync: false  # Manuel olarak Vercel URL'inizi ekleyin
        value: https://your-frontend.vercel.app
      
      # Rate Limiting
      - key: RATE_LIMIT_PER_MINUTE
        value: "60"
      
      # Password Policy
      - key: PASSWORD_MIN_LENGTH
        value: "12"
      - key: BCRYPT_ROUNDS
        value: "12"
      
      # Database Connection Pool (Cross-region optimization)
      - key: DB_POOL_MIN_SIZE
        value: 5
      - key: DB_POOL_MAX_SIZE
        value: 20
      - key: DB_COMMAND_TIMEOUT
        value: 10
      
      # Cache
      - key: CACHE_TTL_SHORT
        value: 60
      - key: CACHE_TTL_MEDIUM
        value: 300
      - key: CACHE_TTL_LONG
        value: 1800
      
      # Redis (Opsiyonel - eğer Redis service ekleyeceksen)
      - key: REDIS_ENABLED
        value: false
      
      # Backup (Opsiyonel)
      - key: BACKUP_ENABLED
        value: false
      
      # OpenAI (Opsiyonel)
      - key: OPENAI_API_KEY
        sync: false  # Manuel olarak ayarla (varsa)

# Database service (Opsiyonel - eğer yeni database kurmak istiyorsan)
# database:
#   name: neso-moduler-db
#   databaseName: neso
#   user: neso
#   plan: starter  # veya free (test için), professional (production için)
#   region: frankfurt  # Frankfurt (EU Central) - Backend ile aynı region olmalı!

# Redis service (Opsiyonel - eğer caching için Redis kullanacaksan)
# redis:
#   name: neso-moduler-redis
#   plan: starter
#   region: frankfurt  # Frankfurt (EU Central) - Backend ile aynı region olmalı!
